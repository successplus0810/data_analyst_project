CREATE DATABASE IF NOT EXISTS quanlysinhvien;
USE quanlysinhvien;

CREATE TABLE SINHVIEN (
MASV INT(3) ZEROFILL NOT NULL,
HOTEN VARCHAR(45) NOT NULL,
MALOP VARCHAR(10) NOT NULL,
NGAYSINH DATE NOT NULL,
GIOITINH VARCHAR(10) NOT NULL,
DIACHI VARCHAR(45) NOT NULL,
PRIMARY KEY (MASV)
);

CREATE TABLE DMHOCPHAN(
MAHP INT(3) ZEROFILL NOT NULL,
TENHP VARCHAR(45) NOT NULL,
SODVHT INT NOT NULL,
MANGANH INT NOT NULL,
HOCKY INT NOT NULL,
PRIMARY KEY (MAHP)
);

CREATE TABLE DIEMHP(
MASV INT(3) ZEROFILL NOT NULL,
MAHP INT(3) ZEROFILL NOT NULL,
DIEMHP DECIMAL(2,1) NOT NULL,
PRIMARY KEY (MASV,MAHP)
);

CREATE TABLE DMLOP(
MALOP VARCHAR(10) NOT NULL,
TENLOP VARCHAR(45) NOT NULL,
MANGANH INT NOT NULL,
KHOAHOC INT NOT NULL,
HEDT VARCHAR(45) NOT NULL,
NAMNHAPHOC INT(4) NOT NULL,
PRIMARY KEY (MALOP)
);

CREATE TABLE DMNGANH(
MANGANH INT NOT NULL,
TENNGANH VARCHAR(45) NOT NULL,
MAKHOA VARCHAR(45) NOT NULL,
PRIMARY KEY(MANGANH)
);

CREATE TABLE DMKHOA(
MAKHOA VARCHAR(10) NOT NULL,
TENKHOA VARCHAR(45) NOT NULL,
PRIMARY KEY (MAKHOA)
)


INSERT INTO quanlysinhvien.DMKHOA (MAKHOA,TENKHOA)
VALUES('CNTT','Công Nghệ Thông Tin'),
	('KT','Kế Toán'),
    ('SP','Sư Phạm');

INSERT INTO quanlysinhvien.DMNGANH (MANGANH,TENNGANH,MAKHOA)
VALUES(140982,'Sư Phạm Toán Tin','SP'),
	(480202,'Tin học ứng dụng','CNTT');

INSERT INTO quanlysinhvien.DMLOP (MALOP,TENLOP,MANGANH,KHOAHOC,HEDT,NAMNHAPHOC)
VALUES('CT11','Cao đẳng tin học',480202,11,'TC',2013),
	('CT12','Cao đẳng tin học',480202,12,'CĐ',2013),
    ('CT13','Cao đẳng tin học',480202,13,'CĐ',2014);

INSERT INTO quanlysinhvien.SINHVIEN (MASV,HOTEN,MALOP,GIOITINH,NGAYSINH,DIACHI)
VALUES(1,'Phan Thanh','CT12','False','1990-12-09','Tuy Phước'),
(2,'Nguyễn Thị Cẩm','CT12','True','1994-12-01','Quy Nhơn'),
(3,'Võ Thị Hà','CT12','True','1995-02-07','An Nhơn'),
(4,'Trần Hoài Nam','CT12','False','1994-05-04','Tây Sơn'),
(5,'Trần Văn Hoàng','CT13','False','1995-04-08','Vĩnh Thạnh'),
(6,'Đặng Thị Thảo','CT13','True','1995-12-06','Quy Nhơn'),
(7,'Lê Thị Sen','CT13','True','1994-12-08','Phù Cát'),
(8,'Nguyễn Văn Huy','CT11','False','1995-04-06','Phù Mỹ'),
(9,'Trần Thị Hoa','CT11','True','1994-09-08','Hoài Nhơn');

INSERT INTO DMHOCPHAN(MAHP,TENHP,SODVHT,MANGANH,HOCKY)
VALUES(1,'Toán cao cấp A1',4,480202,1),
(2,'Tiếng Anh 1',3,480202,1),
(3,'Vật lý đại cương',4,480202,1),
(4,'Tiếng Anh 2',7,480202,1),
(5,'Tiếng Anh 1',3,140909,2),
(6,'Xác suất thống kê',3,140902,2);


INSERT INTO quanlysinhvien.DIEMHP (MASV,MAHP,DIEMHP)
VALUES (002,002,5.9),
(002,003,4.5),
(003,001,4.3),
(003,002,6.7),
(003,003,7.3),
(004,001,4.0),
(004,002,5.2),
(004,003,3.5),
(005,001,9.8),
(005,002,7.9),
(005,003,7.5),
(006,001,6.1),
(006,002,5.6),
(006,003,4.0),
(007,001,6.2);



ALTER TABLE DIEMHP
ADD FOREIGN KEY (MASV) REFERENCES SINHVIEN(MASV), 
ADD FOREIGN KEY (MAHP) REFERENCES DMHOCPHAN(MAHP);
  
ALTER TABLE SINHVIEN
ADD FOREIGN KEY (MALOP) REFERENCES DMLOP(MALOP);

ALTER TABLE DMLOP
ADD FOREIGN KEY (MANGANH) REFERENCES DMNGANH(MANGANH);

ALTER TABLE DMNGANH
ADD FOREIGN KEY (MAKHOA) REFERENCES DMKHOA(MAKHOA);
